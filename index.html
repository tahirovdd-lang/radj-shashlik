<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Radj Shashlik</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU"></script>

<style>
body{margin:0;font-family:Segoe UI;background:#f5f7f6}
header{display:flex;align-items:center;gap:10px;padding:14px;background:#2f7d32;color:#fff}
header img{height:44px}

/* –¢–ê–ë–´ */
.tabs{
display:flex;gap:8px;padding:10px;background:#fff;
overflow-x:auto
}
.tabs button{
border:none;padding:8px 14px;border-radius:20px;
background:#e0e0e0;font-weight:600;
transition:.25s;white-space:nowrap
}
.tabs button.active{
background:#2f7d32;color:#fff;
transform:scale(1.05)
}

/* –ö–û–ù–¢–ï–ù–¢ */
.container{padding:12px;padding-bottom:160px;animation:fade .3s}
.products{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
gap:12px
}

/* –ö–ê–†–¢–û–ß–ö–ò */
.card{
background:#fff;border-radius:14px;padding:10px;
box-shadow:0 4px 10px rgba(0,0,0,.08);
animation:slideUp .35s
}
.card h3{margin:6px 0;font-size:16px}
.price{color:#2f7d32;font-weight:600}
.card button{
width:100%;margin-top:6px;
background:#2f7d32;color:#fff;
border:none;padding:8px;border-radius:8px;
transition:.2s
}
.card button:active{transform:scale(.95)}

/* –ö–û–†–ó–ò–ù–ê */
.cart{
position:fixed;bottom:0;left:0;right:0;
background:#fff;padding:12px;
box-shadow:0 -4px 10px rgba(0,0,0,.15)
}
.cart-items div{
display:flex;justify-content:space-between;
align-items:center;margin:6px 0
}
.qty button{
width:26px;height:26px;border:none;
border-radius:50%;background:#e0e0e0
}

button.main{
background:#2f7d32;color:#fff;border:none;
padding:12px;border-radius:10px;
width:100%;margin-top:8px
}

/* –û–§–û–†–ú–õ–ï–ù–ò–ï */
#confirm{display:none}
select,input{
width:100%;padding:10px;margin-top:6px;
border-radius:8px;border:1px solid #ccc
}
#map{
height:200px;border-radius:12px;
margin-top:8px;display:none
}

/* –ê–ù–ò–ú–ê–¶–ò–ò */
@keyframes slideUp{
from{transform:translateY(20px);opacity:0}
to{transform:translateY(0);opacity:1}
}
@keyframes fade{
from{opacity:0}to{opacity:1}
}
</style>
</head>

<body>

<header>
<img src="https://jocular-sprite-ccad97.netlify.app/logo.png">
<h2>Radj Shashlik</h2>
</header>

<div class="tabs" id="tabs"></div>

<div class="container" id="menu">
<div class="products" id="products"></div>
</div>

<div class="container" id="confirm">
<h3>üßæ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>

<select id="deliveryType" onchange="toggleMap()">
<option value="–î–æ—Å—Ç–∞–≤–∫–∞">üìç –î–æ—Å—Ç–∞–≤–∫–∞</option>
<option value="–°–∞–º–æ–≤—ã–≤–æ–∑">üè† –°–∞–º–æ–≤—ã–≤–æ–∑</option>
</select>

<input id="phone" placeholder="üìû –¢–µ–ª–µ—Ñ–æ–Ω">

<div id="map"></div>

<div id="confirmItems"></div>
<b>–ò—Ç–æ–≥–æ: <span id="confirmTotal">0</span> —Å—É–º</b>

<button class="main" onclick="sendOrder()">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
<button class="main" onclick="back()">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
</div>

<div class="cart">
<div class="cart-items" id="cartItems"></div>
<b>–ò—Ç–æ–≥–æ: <span id="total">0</span> —Å—É–º</b>
<button class="main" onclick="openConfirm()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
</div>

<script>
const tg = Telegram.WebApp;
tg.expand();

/* –ö–ê–¢–ï–ì–û–†–ò–ò */
const categories=[
"–®–∞—à–ª—ã–∫","–°–∞–ª–∞—Ç—ã","–ü–µ—Ä–≤—ã–µ –±–ª—é–¥–∞",
"–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –±–ª—é–¥–∞","–ë–ª—é–¥–∞ –Ω–∞ –≥—Ä–∏–ª–µ",
"–•–ª–µ–±","–ù–∞–ø–∏—Ç–∫–∏"
];

/* –ë–õ–Æ–î–ê */
const products=[
{cat:"–®–∞—à–ª—ã–∫",name:"–®–∞—à–ª—ã–∫ –≥–æ–≤—è–¥–∏–Ω–∞",price:65000},
{cat:"–®–∞—à–ª—ã–∫",name:"–®–∞—à–ª—ã–∫ –∫—É—Ä–∏—Ü–∞",price:45000},
{cat:"–°–∞–ª–∞—Ç—ã",name:"–°–∞–ª–∞—Ç –¶–µ–∑–∞—Ä—å",price:45000},
{cat:"–ü–µ—Ä–≤—ã–µ –±–ª—é–¥–∞",name:"–®—É—Ä–ø–∞",price:50000},
{cat:"–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –±–ª—é–¥–∞",name:"–ü–ª–æ–≤",price:55000},
{cat:"–ë–ª—é–¥–∞ –Ω–∞ –≥—Ä–∏–ª–µ",name:"–°—Ç–µ–π–∫ –≥–æ–≤—è–∂–∏–π",price:95000},
{cat:"–•–ª–µ–±",name:"–õ–µ–ø—ë—à–∫–∞",price:6000},
{cat:"–ù–∞–ø–∏—Ç–∫–∏",name:"–ß–∞–π",price:5000}
];

let cart={},currentCat=categories[0];
let address="";

/* –¢–ê–ë–´ */
function renderTabs(){
const el=document.getElementById("tabs");
el.innerHTML="";
categories.forEach(c=>{
el.innerHTML+=`
<button class="${c===currentCat?'active':''}"
onclick="selectCat('${c}')">${c}</button>`;
});
}

function selectCat(c){
currentCat=c;
renderTabs();
renderProducts();
}

/* –ú–ï–ù–Æ */
function renderProducts(){
const el=document.getElementById("products");
el.innerHTML="";
products.filter(p=>p.cat===currentCat).forEach(p=>{
el.innerHTML+=`
<div class="card">
<h3>${p.name}</h3>
<div class="price">${p.price} —Å—É–º</div>
<button onclick="add('${p.name}',${p.price})">–î–æ–±–∞–≤–∏—Ç—å</button>
</div>`;
});
}

/* –ö–û–†–ó–ò–ù–ê */
function add(n,p){
cart[n]?cart[n].qty++:cart[n]={qty:1,price:p};
renderCart();
}

function plus(n){cart[n].qty++;renderCart()}
function minus(n){cart[n].qty--;if(cart[n].qty<=0)delete cart[n];renderCart()}

function renderCart(){
const el=document.getElementById("cartItems");
el.innerHTML="";
let total=0;
for(let n in cart){
total+=cart[n].qty*cart[n].price;
el.innerHTML+=`
<div>
<span>${n} √ó ${cart[n].qty}</span>
<span class="qty">
<button onclick="minus('${n}')">‚àí</button>
<button onclick="plus('${n}')">+</button>
</span>
</div>`;
}
document.getElementById("total").innerText=total;
}

/* –û–§–û–†–ú–õ–ï–ù–ò–ï */
function openConfirm(){
if(!Object.keys(cart).length){alert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞");return}
document.getElementById("menu").style.display="none";
document.getElementById("confirm").style.display="block";
renderConfirm();
toggleMap();
}

function back(){
document.getElementById("confirm").style.display="none";
document.getElementById("menu").style.display="block";
}

function renderConfirm(){
let el=document.getElementById("confirmItems");
el.innerHTML="";
let total=0;
for(let n in cart){
el.innerHTML+=`<div>${n} √ó ${cart[n].qty}</div>`;
total+=cart[n].qty*cart[n].price;
}
document.getElementById("confirmTotal").innerText=total;
}

/* –î–û–°–¢–ê–í–ö–ê */
function toggleMap(){
document.getElementById("map").style.display=
document.getElementById("deliveryType").value==="–î–æ—Å—Ç–∞–≤–∫–∞"?"block":"none";
}

/* –û–¢–ü–†–ê–í–ö–ê */
function sendOrder(){
tg.sendData(JSON.stringify({
phone:document.getElementById("phone").value,
delivery:document.getElementById("deliveryType").value,
address,cart
}));
}

/* –ö–ê–†–¢–ê */
ymaps.ready(()=>{
const map=new ymaps.Map("map",{center:[41.31,69.28],zoom:12});
map.events.add("click",e=>{
address=e.get("coords").join(", ");
});
});

renderTabs();
renderProducts();
renderCart();
</script>

</body>
</html>
